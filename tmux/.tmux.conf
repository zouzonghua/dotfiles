###############################################################################
# enable vim
# for macOS need brew install reattach-to-user-namespace
###############################################################################
setw -g mode-keys vi # 开启vi风格后，支持vi的c-d、c-u、hjkl等快捷键
bind escape copy-mode # 绑定esc键为进入复制模式
bind -T copy-mode-vi v send-keys -X begin-selection # 绑定v键为开始选择文本
bind -T copy-mode-vi y send -X  copy-pipe-and-cancel "reattach-to-user-namespace pbcopy" \; display-message "copied to system clipboard" # 绑定y键为复制选中文本

###############################################################################
# send prefix
###############################################################################
set-option -g prefix C-a
unbind-key C-a
bind-key C-a send-prefix

###############################################################################
# enable mouse
###############################################################################
set-option -g mouse on

###############################################################################
# Switch window
###############################################################################
bind -r k select-pane -U # k => ↑
bind -r j select-pane -D # j => ↓
bind -r h select-pane -L # h => ←
bind -r l select-pane -R # l => →

bind -r ^p swap-pane -U
bind -r ^n swap-pane -D

bind -r ^k resizep -U 2
bind -r ^j resizep -D 2
bind -r ^h resizep -L 2
bind -r ^l resizep -R 2

# Shift arrow to switch windows
bind -n S-Left previous-window
bind -n S-Right next-window


###############################################################################
# Set easier window split keys
###############################################################################
bind-key - split-window -v
bind-key | split-window -h

###############################################################################
# Config reload
###############################################################################
bind-key r source-file ~/.tmux.conf \; display-message "tmux.conf reloaded"

###############################################################################
# True color
# https://gist.github.com/bbqtd/a4ac060d6f6b9ea6fe3aabe735aa9d95
# https://gist.github.com/nicm/ea9cf3c93f22e0246ec858122d9abea1
# fix: Htop Color Error
# 1. git clone https://gist.github.com/nicm/ea9cf3c93f22e0246ec858122d9abea1
# 2. cd ea9cxxxx
# 3. tic tmux-256color.terminfo
###############################################################################

set-option default-terminal "tmux-256color"
set-option -ga terminal-overrides ",*256col*:RGB"

###############################################################################
# Config
###############################################################################
set-option -sg escape-time 10
set-option -g focus-events on

###############################################################################
# Status Bar
# brew install tmux-mem-cpu-load
###############################################################################
set -g status-left '   #S ❱ '
set -g status-left-length 100
set -g status-right "#{battery_status_bg} #{battery_icon}  #{battery_percentage} ❰ %a %Y-%m-%d  %H:%M #[fg=#333333]#(tmux-mem-cpu-load --colors --powerline-right --interval 3 --graph-lines=0 --averages-count=0 ) #[default]"
set -g status-right-length 220
# 状态栏背景颜色
set -g status-bg '#333333'
# 状态栏前景颜色
 set -g status-fg '#ffffff'


###############################################################################
# Plugins
# https://github.com/tmux-plugins/list
# git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm
# prefix + I
# prefix + U
# prefix + alt + u
###############################################################################
set -g @plugin 'tmux-plugins/tpm'

set -g @plugin 'tmux-plugins/tmux-battery'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'

# battery
set -g @batt_icon_charge_tier8 ''
set -g @batt_icon_charge_tier7 ''
set -g @batt_icon_charge_tier6 ''
set -g @batt_icon_charge_tier5 ''
set -g @batt_icon_charge_tier4 ''
set -g @batt_icon_charge_tier3 ''
set -g @batt_icon_charge_tier2 ''
set -g @batt_icon_charge_tier1 ''
set -g @batt_icon_status_charged " "
set -g @batt_icon_status_charging " "
set -g @batt_icon_status_discharging "​"
set -g @batt_icon_status_attached " "
set -g @batt_icon_status_unknown " "
set -g @batt_color_status_primary_charged '#3daee9'
set -g @batt_color_status_primary_charging '#3daee9'

# restore vim/neovim session
set -g @resurrect-strategy-vim 'session'
set -g @resurrect-strategy-nvim 'session'
set -g @continuum-restore 'on'
set -g @resurrect-capture-pane-contents 'on'

# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
run '~/.tmux/plugins/tpm/tpm'

